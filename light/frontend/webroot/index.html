<!DOCTYPE html>
<html>
    <head>
        <title>FrostWire Light</title>
        <link rel="preload" href="/libs/react-16.2.0/development/react.development.js" as="script"/>
        <link rel="preload" href="/libs/react-16.2.0/development/react-dom.development.js" as="script"/>
        <script src="/libs/sockjs-1.1.4/sockjs.js"></script>
        <script src="/libs/sockjs-1.1.4/vertx-eventbus.js"></script>
    </head>

    <body>
        <div id="root">FrostWire Light</div>

<script>
var busOptions = {
    vertxbus_reconnect_attempts_max: Infinity, // Max reconnect attempts
    vertxbus_reconnect_delay_min: 1000, // Initial delay (in ms) before first reconnect attempt
    vertxbus_reconnect_delay_max: 5000, // Max delay (in ms) between reconnect attempts
    vertxbus_reconnect_exponent: 2, // Exponential backoff factor
    vertxbus_randomization_factor: 0.5 // Randomization factor between 0 and 1
};

var searchId=0;
var eb = new EventBus('http://localhost:9191/bus', busOptions);
eb.enableReconnect(true);

eb.onopen = function() {
    eb.registerHandler('search', onSearchResponse);
}

function onSearchResponse(error, message) {
    console.log('onFooAddress(error, message=' + JSON.stringify(message) + ')');
    return message;
}

function onSearchButton() {
  var message = document.querySelector('#message').value;
  console.log("onSearchButton() sending message '" + message + "' to 'search' address");
  eb.send('search', { query:message, 'searchId': searchId });
  searchId++;
}

function onShutdownButton() {
  console.log("onShutdownButton()");
}
</script>
        <input type="text" value="" placeholder="What are you looking for?" id="message"/>
        <input type="button" value="Search" onclick="onSearchButton();"/>
        <input type="button" value="Shutdown Server" onclick="onShutdownButton()"/>
    </body>
</html>
